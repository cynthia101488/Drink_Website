<html>

<head>
    
     <meta charset="utf-8">
 	 <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 	 <meta name="description" content="">
 	<meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
  	<meta name="generator" content="Jekyll v3.8.5">
    <title>會員中心 | balance</title>
    
     <link href="statics/css/bootstrap.min.css" rel="stylesheet">
  	 <link href="statics/css/font-awesome.min.css" rel="stylesheet">
 	 <link href="statics/icon/LOGO.png" type="image/x-png" rel="icon">
 	 <link href="statics/icon/LOGO.png" type="image/x-png" rel="shortcut icon">
 	 
     <style>
    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
	
	.tabs-container {
	  width: 80%;
	  height: 100%;
	  margin:0 auto;
	  border-radius: 10px 10px 0 0;
	  box-shadow: 0 0 2px rgba(0, 0, 0, 0.225), 0 0 1.5px rgba(0, 0, 0, 0.125);
	}
	
	.tabs-pages {
	  width: 100%;
	  display: flex;
	  text-align: center;
	  font-size:20px;
	  flex-direction: row;
	  border-bottom: 1px solid rgba(0, 0, 0, 0.125);
	}
	
	.tabs-pages:focus,
	.tabs-pages:hover {
	  cursor: pointer;
	}
	
	.tab {
	  width: 100%;
	  padding: 1.5em 1.2em;
	  color: white;
	  background-color: #A9A9A9;
	}
	
	.tab:hover {
	  background-color: #808080;
	}
	
	.tab:nth-child(1) {
	  border-radius: 10px 0 0 0;
	}
	
	.tab:nth-last-child(1) {
	  border-radius: 0 10px 0 0;
	}
	
	.tab.active {
	  background-color: #000000;
	}
	
	.tabs-contents {
	  display: block;
	  width: 100%;
	  height: auto;
	  position: relative;
	}
	
	.tab-c {
	  position: absolute;
	  top: 0;
	  left: 0;
	  opacity: 0;
	  width: 100%;
	  height: auto;
	  color: black;
	  transition: opacity 1s;
	}
	
	.tab-c.active {
	  opacity: 1;
	}
	
	.inner-content {
	  position: relative;
	  padding: 2em;
	}
	.font{
	  display: flex;
	  height:100px;	 
	  font-size:40px;
	}
	.data{
	  display: flex;
	  height:100px;
	  text-align: center;	 
	  font-size:30px;
	}
    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }
  </style>
  <!-- Custom styles for this template -->
  <link href="statics/css/product.css" rel="stylesheet">
  <link href="statics/css/jquery-confirm.css" rel="stylesheet">
  <script src="statics/js/jquery-3.4.1.min.js"></script>
  <script src="statics/js/jquery-confirm.js"></script>
  <script src="statics/js/big.min.js"></script>
</head>

<body>
<div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
    <a id="logo" href ="balance.html"><img src= "statics/icon/LOGO.png" width ="60" height="60"></a>
    <a class="my-0 mr-md-auto" style="font-size:xx-large">balance</a>
    <nav class="my-2 my-md-0 mr-md-3">
     <a  id="member" class="p-2 text-dark" href="Member.html">Member</a>
     <a  id="order" class="p-2 text-dark" href="orderMember.html">訂單查詢</a>
      <a  id="product" class="p-2 text-dark" href="product.html">Product</a>  
      <a id="cup" class="p-2 text-dark" href="cupview.html">Cup</a>
      
    </nav>
    <a id="cart"href="cart.html">
    <img src="statics/img/cart.png" width="50px">
	</a>
  </div>

	        <div class="table-responsive">
         <table id="coupon_table" class="table table-striped table-sm">
           <thead>
             <tr>      
               <th class="text-center" style="width: 10%">優惠券代碼</th>
               <th class="text-center" style="width: 10%">優惠券面額</th>
             </tr>
           </thead>
         </table>
         <script>
				  var url_string = window.location.href;
				  var url = new URL(url_string);
				  var id = url.searchParams.get("member_id");
				  function getOrderData() {
					  $.ajax({
				          type: "GET",
				          url: "api/coupon.do",
				          data: "id=" + id,
				          crossDomain: true,
				          cache: false,
				          dataType: 'json',
				          timeout: 5000,
				          success: function (response) {
				              if(response.status == 200){
				            	  updateCoupon(response.response.data);
				              }
				          },
				          error: function () {
				              alert("無法連線到伺服器！");
				          }
				    });
				  }
				 getOrderData();
				 getMember();
				  function getMember(){
				  	var url_string = window.location.href;
				      var url = new URL(url_string);
				      var id = url.searchParams.get("member_id");       
				      if(id=="null"){
				      	//alert("a");
							document.getElementById("member").href="login.html";
							document.getElementById("cart").href="cart.html?member_id="+id;
							document.getElementById("balance").href="balance.html?member_id="+id;
						}
				      else{
				             // 發出POST的AJAX請求
				                  $.ajax({
				                          type: "GET",
				                          url: "api/member.do",
				                          data: "id=" + id,
				                          crossDomain: true,
				                          cache: false,
				                          dataType: 'json',
				                          timeout: 5000,
				                          success: function (response) {                                    
				                              if(response.status == 200){
				                              	updateName(response.response.data);                                    
				                              }
				                          },
				                          error: function () {
				                              alert("無法連線到伺服器！");
				                          }
				                  });    	
				  }
				  }
				  function updateName(data) {            
				  	$.each(data, function (key, value){ 
				  		var element = document.getElementById("member");
				  		element.innerHTML = value['name']; 	
				  	});
				  }
				 function updateCoupon(data) {  
					  var temp = '';	  
					  $.each(data, function (key, value) {
						  temp +='<tr>';
						  temp += '<td class="align-middle text-center">' +value['sn']+ '</td>';
						  temp += '<td class="align-middle text-center">' + value['price'] + '</td>';		 
						  temp += '</tr>';	  
					  });	  
					  $('#coupon_table').append(temp);	
					  document.getElementById("product").href="product.html?member_id="+id;
                      document.getElementById("logo").href="balance.html?member_id="+id;
                      document.getElementById("cart").href="cart.html?member_id="+id;
                      document.getElementById("order").href="orderMember.html?member_id="+id;
                      document.getElementById("member").href="Member.html?member_id="+id;
                      document.getElementById("cup").href="cupview.html?member_id="+id;
				  }
				  
  			</script>
       </div>
	        
	        
	        
	      </div>
	    </div>
  </div>
</div>

        

</body>

</html>